#!/bin/bash

echo "---> Installing application source"
cp -r /tmp/src/ /opt/app-root

chmod 775 -R /opt/app-root

if [ "$(ls /tmp/artifacts/ 2>/dev/null)" ]; then
  echo "---> Restoring build artifacts..."
  mv /tmp/artifacts/* /opt/app-root/node_modules
fi

cd /opt/app-root

echo "---> Building your Node application from source"
npm install --production